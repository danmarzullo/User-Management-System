CREATE SCHEMA MASTER;
CREATE SCHEMA CHANGES;
CREATE SCHEMA SCHEDULING;
CREATE SCHEMA TSS;
CREATE SCHEMA SYSTEM;

CREATE TABLE MASTER.PRODUCT_MASTER
(ATTESTATION_ID IDENTITY NOT NULL,
PRODUCT_ID BIGINT NOT NULL,
TOP_NCV_PNCV BOOLEAN NOT NULL,
SRC_MNGMT_TOOL VARCHAR(64) NOT NULL,
COMPL_WP CHAR NOT NULL,
DBMS_USED VARCHAR(32),
SRC_RESOURCES VARCHAR(64),
MAINFRAME_SRC_LOC_DSNAME VARCHAR(512),
NON_MAINFRAME_SRC_PHYS_LOC VARCHAR(512),
ENDEVOR_PRODUCT VARCHAR(512),
VM_VSE_SRC_LOC VARCHAR(2048),
MIGRATION_TGT_DATE DATE,
ESCROW_LOC_NOT_DCC VARCHAR(1550),
POLICY_EXCP_GRANTED BOOLEAN NOT NULL,
REASON_EXCP VARCHAR(48),
EXCP_EXP_ON DATE,
EXCP_APPROVERS VARCHAR(255),
SRC_HOST_ACCESS_ENABLED BOOLEAN NOT NULL,
SRC_PHYS_SYS_SRC_SECURE BOOLEAN NOT NULL,
SRC_PATCHES_APPLIED_GIS BOOLEAN NOT NULL,
SRC_SYS_PROTECTED_ANTIVIRUS BOOLEAN,
IS_BACKUP BOOLEAN NOT NULL,
CUR_BCKUP_METHOD VARCHAR(255),
BCKUP_FREQ VARCHAR(150),
OFST_STOR_DETAILS VARCHAR(255),
RESTORE_FREQ VARCHAR(150),
LAST_SUC_RESTORE_DATE DATE,
BLD_MACH_HOSTNM VARCHAR(2500),
BLD_MACH_PHYS_LOC VARCHAR(1000),
PMF_W_ACC VARCHAR(500),
BLD_HOST_ACCESS_ENABLED BOOLEAN NOT NULL,
BLD_PHYS_SYS_SRC_SECURE BOOLEAN NOT NULL,
BLD_PATCHES_APPLIED_GIS BOOLEAN NOT NULL,
BLD_SYS_PROTECTED_ANTIVIRUS BOOLEAN,
BLD_SERVERS_CAN_BE_RCVRD BOOLEAN NOT NULL,
BLD_IF_ANY_NO_RESP BOOLEAN NOT NULL,
SRC_REVIEW_DOC_NAME VARCHAR(128) NOT NULL,
IS_Q1_FILED BOOLEAN NOT NULL,
IS_Q3_FILED BOOLEAN NOT NULL,
ADD_CMNTS VARCHAR(500),
SRC_LOC_AND_SRVRNM VARCHAR(255),
STAT_REV BOOLEAN,
SRC_ACCESS_REV_CMPLD BOOLEAN NOT NULL,
BLD_ACCESS_REV_CMPLD BOOLEAN NOT NULL,
HARVEST_ENVIRONMENTS VARCHAR (8000),
CREATED TIMESTAMP NOT NULL,
CRTD_BY VARCHAR(40) NOT NULL,
PRIMARY KEY (ATTESTATION_ID));

CREATE TABLE MASTER.PRODUCT_MASTER_CHANGES 
(ATTESTATION_ID BIGINT NOT NULL,
PRODUCT_ID BIGINT NOT NULL,
TOP_NCV_PNCV BOOLEAN NOT NULL,
SRC_MNGMT_TOOL VARCHAR(64) NOT NULL,
COMPL_WP CHAR NOT NULL,
DBMS_USED VARCHAR(32),
SRC_RESOURCES VARCHAR(64),
MAINFRAME_SRC_LOC_DSNAME VARCHAR(512),
NON_MAINFRAME_SRC_PHYS_LOC VARCHAR(512),
ENDEVOR_PRODUCT VARCHAR(512),
VM_VSE_SRC_LOC VARCHAR(2048),
MIGRATION_TGT_DATE DATE,
ESCROW_LOC_NOT_DCC VARCHAR(1550),
POLICY_EXCP_GRANTED BOOLEAN NOT NULL,
REASON_EXCP VARCHAR(48),
EXCP_EXP_ON DATE,
EXCP_APPROVERS VARCHAR(255),
SRC_HOST_ACCESS_ENABLED BOOLEAN NOT NULL,
SRC_PHYS_SYS_SRC_SECURE BOOLEAN NOT NULL,
SRC_PATCHES_APPLIED_GIS BOOLEAN NOT NULL,
SRC_SYS_PROTECTED_ANTIVIRUS BOOLEAN,
IS_BACKUP BOOLEAN NOT NULL,
CUR_BCKUP_METHOD VARCHAR(255),
BCKUP_FREQ VARCHAR(150),
OFST_STOR_DETAILS VARCHAR(255),
RESTORE_FREQ VARCHAR(150),
LAST_SUC_RESTORE_DATE DATE,
BLD_MACH_HOSTNM VARCHAR(2500),
BLD_MACH_PHYS_LOC VARCHAR(1000),
PMF_W_ACC VARCHAR(500),
BLD_HOST_ACCESS_ENABLED BOOLEAN NOT NULL,
BLD_PHYS_SYS_SRC_SECURE BOOLEAN NOT NULL,
BLD_PATCHES_APPLIED_GIS BOOLEAN NOT NULL,
BLD_SYS_PROTECTED_ANTIVIRUS BOOLEAN,
BLD_SERVERS_CAN_BE_RCVRD BOOLEAN NOT NULL,
BLD_IF_ANY_NO_RESP BOOLEAN NOT NULL,
SRC_REVIEW_DOC_NAME VARCHAR(128) NOT NULL,
IS_Q1_FILED BOOLEAN NOT NULL,
IS_Q3_FILED BOOLEAN NOT NULL,
ADD_CMNTS VARCHAR(500),
SRC_LOC_AND_SRVRNM VARCHAR(255),
STAT_REV BOOLEAN,
SRC_ACCESS_REV_CMPLD BOOLEAN NOT NULL,
BLD_ACCESS_REV_CMPLD BOOLEAN NOT NULL,
HARVEST_ENVIRONMENTS VARCHAR (8000),
CREATED TIMESTAMP NOT NULL,
CRTD_BY VARCHAR(40) NOT NULL,
LST_MOD_DT TIMESTAMP NOT NULL,
LST_MOD_PMFKEY VARCHAR(9) NOT NULL,
STATUS INT NOT NULL,
STATUS_DT TIMESTAMP NOT NULL,
APPROVERS_PMFKEY_DT VARCHAR(1000),
FINAL_APPROVAL_COMMENT VARCHAR(4000),
PENDING_APPROVER_PMFKEY VARCHAR(9),
REJECTOR_PMFKEY VARCHAR(9),
REASON_REJECTION VARCHAR(4000));

CREATE TABLE MASTER.PRODUCT
(PRODUCT_ID IDENTITY NOT NULL,
PROD_NAME VARCHAR(150) NOT NULL,
APPROVERS_PMFKEY VARCHAR(1000) NOT NULL,
RELEASE VARCHAR(256) NOT NULL,
BU VARCHAR(40) NOT NULL,
CSU VARCHAR(17) NOT NULL,
PRODUCT_FAMILY VARCHAR(60) NOT NULL,
PROD_STAT VARCHAR(12) NOT NULL,
ERC_ID BIGINT NOT NULL,
SEM_ID BIGINT NOT NULL,
SCAS VARCHAR(128) NOT NULL,
PRIMARY KEY (PRODUCT_ID));

CREATE TABLE MASTER.PRODUCT_CHANGES
(PRODUCT_ID BIGINT NOT NULL,
PROD_NAME VARCHAR(60) NOT NULL,
APPROVERS_PMFKEY VARCHAR(1000) NOT NULL,
RELEASE VARCHAR(40) NOT NULL,
BU VARCHAR(40) NOT NULL,
CSU VARCHAR(17) NOT NULL,
PRODUCT_FAMILY VARCHAR(60) NOT NULL,
PROD_STAT VARCHAR(12) NOT NULL,
ERC_ID BIGINT NOT NULL,
SEM_ID BIGINT NOT NULL,
SCAS VARCHAR(128) NOT NULL,
CHNG_DT TIMESTAMP  NOT NULL,
CHNG_AUTH VARCHAR(40) NOT NULL,
CHNG_OPER VARCHAR(20)  NOT NULL);

CREATE TABLE MASTER.PRODUCT_FAMILY
(PRODFAM_ID IDENTITY NOT NULL,
PRODFAM_NAME VARCHAR(60) NOT NULL,
PRIMARY KEY (PRODFAM_ID));

CREATE TABLE MASTER.BU
(BU_ID IDENTITY NOT NULL,
BU VARCHAR(10) NOT NULL,
PRIMARY KEY (BU_ID));

CREATE TABLE MASTER.CSU
(CSU_ID IDENTITY NOT NULL,
CSU VARCHAR(17) NOT NULL,
PRIMARY KEY (CSU_ID));

CREATE TABLE MASTER.PRODUCT_STATUS
(PROD_STAT_ID IDENTITY NOT NULL,
PROD_STAT VARCHAR(10) NOT NULL,
PRIMARY KEY (PROD_STAT_ID));

CREATE TABLE MASTER.COMPLIANT_WP
(COMPL_WP_ID IDENTITY NOT NULL,
COMPL_WP_STAT VARCHAR(1) NOT NULL,
PRIMARY KEY (COMPL_WP_ID));

CREATE TABLE MASTER.SRC_CODE_MNGMT_TOOL
(SRC_MNGMT_TOOL_ID IDENTITY NOT NULL,
SRC_MNGMT_TOOL_NM VARCHAR(20) NOT NULL,
PRIMARY KEY (SRC_MNGMT_TOOL_ID));

CREATE TABLE MASTER.EXCEPTION_APPROVERS
(EXC_APP_ID IDENTITY NOT NULL,
PMFKEY VARCHAR(7) NOT NULL,
NAME VARCHAR(60) NOT NULL,
IS_EMPLOYEE BOOLEAN DEFAULT 'Y' NOT NULL,
PRODUCT_ID BIGINT NOT NULL,
PRIMARY KEY (EXC_APP_ID));

CREATE TABLE CHANGES.CHANGES
(CHANGE_ID IDENTITY NOT NULL,
DATAPOINT_ID BIGINT NOT NULL,
OLD_VALUE VARCHAR(60) NOT NULL,
NEW_VALUE VARCHAR(60) NOT NULL,
TIMESTAMP TIMESTAMP NOT NULL,
CHNG_AUTH VARCHAR(7) NOT NULL,
CHNG_OPER VARCHAR(20) NOT NULL,
PRIMARY KEY (CHANGE_ID));

CREATE TABLE CHANGES.DATAPOINTS
(DATAPOINT_ID IDENTITY NOT NULL,
DATAPOINT_NAME VARCHAR(60) NOT NULL,
PRIMARY KEY (DATAPOINT_ID));

CREATE TABLE CHANGES.DATAPOINTS_CHANGES
(DATAPOINT_ID BIGINT NOT NULL,
DATAPOINT_NAME VARCHAR(60) NOT NULL,
CHNG_DT TIMESTAMP  NOT NULL,
CHNG_AUTH VARCHAR(40) NOT NULL,
CHNG_OPER VARCHAR(20)  NOT NULL);

CREATE TABLE SCHEDULING.SCHEDULING
(SCHEDULE_ID IDENTITY NOT NULL,
PRODUCT_ID BIGINT NOT NULL,
SCHEDULED_BY VARCHAR(40) NOT NULL,
CREATED_DT TIMESTAMP NOT NULL,
SCHEDULE_TIMESTAMP TIMESTAMP NOT NULL,
COMPLETED BOOLEAN DEFAULT 'N' NOT NULL,
PRIMARY KEY (SCHEDULE_ID));

CREATE TABLE SCHEDULING.SCHEDULING_CHANGES
(SCHEDULE_ID BIGINT NOT NULL,
PRODUCT_ID BIGINT NOT NULL,
SCHEDULED_BY VARCHAR(40) NOT NULL,
CREATED_DT TIMESTAMP NOT NULL,
SCHEDULE_TIMESTAMP TIMESTAMP NOT NULL,
COMPLETED BOOLEAN DEFAULT 'N' NOT NULL,
CHNG_DT TIMESTAMP  NOT NULL,
CHNG_AUTH VARCHAR(40) NOT NULL,
CHNG_OPER VARCHAR(20)  NOT NULL);

CREATE TABLE MASTER.ATTESTATION_TYPES
(ATTEST_TYPE_ID IDENTITY NOT NULL,
ATTEST_TYPE VARCHAR(20) NOT NULL,
PRIMARY KEY (ATTEST_TYPE_ID));

CREATE TABLE MASTER.RESTORE_FREQUENCY
(RESTORE_FREQ_ID IDENTITY NOT NULL,
RESTORE_FREQ VARCHAR(20) NOT NULL,
PRIMARY KEY (RESTORE_FREQ_ID));

CREATE TABLE SYSTEM.ACTIVE_USERS
(USER_ID IDENTITY NOT NULL,
GUID VARCHAR(64) NOT NULL,
LAST_ACTION TIMESTAMP NOT NULL,
IS_ADMIN BOOLEAN NOT NULL,
PMFKEY VARCHAR(7) NOT NULL,
PRIMARY KEY (USER_ID));

CREATE TABLE MASTER.CSV_HISTORICAL(
DASHBOARD VARCHAR(10) NOT NULL,
FY11BU VARCHAR(10) NOT NULL,
FY10BU VARCHAR(10) NOT NULL,
FY14CSU VARCHAR(10) NOT NULL,
PRODFAM_NAME VARCHAR(60) NOT NULL,
PRODUCT VARCHAR(60) NOT NULL,
RELEASE VARCHAR(40) NOT NULL,
PROD_STAT VARCHAR(10) NOT NULL,
ERC_NAME VARCHAR(60) NOT NULL,
ERC_PMFKEY VARCHAR(7) NOT NULL,
SEM_NAME VARCHAR(60) NOT NULL,
SEM_PMFKEY VARCHAR(7) NOT NULL,
TOP_NCV_PNCV BOOL NOT NULL,
SCA_NAME VARCHAR(60) NOT NULL,
SCA_PMFKEY VARCHAR(7) NOT NULL,
SRC_MNGMT_TOOL VARCHAR(40),
COMPL_WP VARCHAR(5) NOT NULL,
DBMS_USED VARCHAR(30),
MAINFRAME_SRC_LOC_DSNAME VARCHAR(255), 
NON_MAINFRAME_SRC_PHYS_LOC VARCHAR(255),
MIGRATION_TGT_DATE DATE,
SRC_MNGMT_TOOL_NM VARCHAR(20),
ESCROW_LOC_NOT_DCC VARCHAR(255),
POLICY_EXCP_GRANTED BOOL NOT NULL, 
REASON_EXCP VARCHAR(48) NOT NULL,
EXCP_EXP_ON DATE NOT NULL,
EXC_APP_NAME VARCHAR(60) NOT NULL,
SRC_HOST_ACCESS_ENABLED BOOL NOT NULL,
SRC_PHYS_SYS_SRC_SECURE BOOL NOT NULL,
SRC_PATCHES_APPLIED_GIS BOOL NOT NULL,
SRC_SYS_PROTECTED_ANTIVIRUS BOOL NOT NULL,
IS_BACKUP BOOL NOT NULL,
CUR_BCKUP_METHOD VARCHAR(255), 
BACKUP_FREQ VARCHAR(150),
OFST_STOR_DETAILS VARCHAR(255),
RESTORE_FREQ VARCHAR(20),
LAST_SUC_RESTORE_DATE DATE,
BLD_MACH_HOSTNM VARCHAR(255),
BLD_MACH_PHYS_LOC VARCHAR(255),
BLD_HOST_ACCESS_ENABLED BOOL NOT NULL,
BLD_PHYS_SYS_SRC_SECURE BOOL NOT NULL,
BLD_PATCHES_APPLIED_GIS BOOL NOT NULL,
BLD_SYS_PROTECTED_ANTIVIRUS BOOL NOT NULL,
BLD_SERVERS_CAN_BE_RCVRD BOOL NOT NULL,
BLD_IF_ANY_NO_RESP BOOL NOT NULL,
SRC_REVIEW_DOC_NAME VARCHAR(255) NOT NULL,
IS_Q1_FILED BOOL NOT NULL,
IS_Q3_FILED BOOL NOT NULL,
LAST_UPDATE_NAME VARCHAR(60) NOT NULL,
ADD_CMNTS VARCHAR(5000),
UPDT_AGING_PER TINYINT NOT NULL);

CREATE TABLE MASTER.CSV_HDC(
PRODUCT VARCHAR(60) NOT NULL,
RELEASE VARCHAR(40) NOT NULL,
SCA_NAME VARCHAR(60) NOT NULL,
SEM_NAME VARCHAR(60) NOT NULL,   
RPT_PREP_NAME VARCHAR(60) NOT NULL,
ATTEST_DATE DATE NOT NULL,
SRC_LOC_AND_SRV VARCHAR(255) NOT NULL,
PROD_STAT BOOL,
LST_CHNGS VARCHAR(5000) NOT NULL,
SRC_REV_CMPLTD BOOL NOT NULL,
WHOHAS_REP_LOC VARCHAR(60) NOT NULL,
CNTRL_PROF VARCHAR(60) NOT NULL,
LST_ACCESSORS VARCHAR(60) NOT NULL,
BLD_SERV_SEC_REV VARCHAR(255) NOT NULL,
BLD_MACH_HOSTNM VARCHAR(255) NOT NULL,
BLD_MACH_PHYS_LOC VARCHAR(255) NOT NULL,
PMF_W_ACC VARCHAR(500) NOT NULL,
OTHER_ATT_ITEMS VARCHAR(5000) NOT NULL); 

CREATE TABLE SYSTEM.PREFERENCES
(PREF_ID IDENTITY NOT NULL,
BUILD_NUMBER SMALLINT NOT NULL,
PREF_TIMESTAMP TIMESTAMP NOT NULL,
ATTEST_FREQ TINYINT NOT NULL,
PRIMARY KEY (PREF_ID));

CREATE TABLE SYSTEM.ADMIN
(ADMIN_ID IDENTITY NOT NULL,
PMFKEY VARCHAR(7) NOT NULL,
PRIMARY KEY (ADMIN_ID));

CREATE TABLE MASTER.EMPLOYEE
(EMPLOYEE_ID IDENTITY NOT NULL,
EMPLOYEE_NAME VARCHAR(60) NOT NULL,
PMFKEY VARCHAR(7) NOT NULL,
IS_EMPLOYEE BOOL NOT NULL,
PRIMARY KEY (EMPLOYEE_ID));


CREATE TABLE TSS.USER_ACCESS
(USER_ACCESS_ID IDENTITY NOT NULL,
ATTESTATION_ID BIGINT NOT NULL,
REPOSITORY INT NOT NULL,
SYSID VARCHAR(8),
USER_NAME VARCHAR(32) NOT NULL,
PMFKEY VARCHAR(8) NOT NULL,
PROFILE_NAME VARCHAR(255) NOT NULL,
PROFILE_DESC VARCHAR(255) NOT NULL,
RESCLASS VARCHAR(8) NOT NULL,
AUTH VARCHAR(255) NOT NULL,
AUTH_TYPE VARCHAR(1),
ACCESS VARCHAR(9),
CHNG_DT VARCHAR(25),
ADMIN VARCHAR(20),
PRIMARY KEY (USER_ACCESS_ID));

CREATE TABLE TSS.USER_ACCESS_ADDED
(USER_ACCESS_ADDED_ID IDENTITY NOT NULL,
ATTESTATION_ID BIGINT NOT NULL,
REPOSITORY INT NOT NULL,
SYSID VARCHAR(8),
USER_NAME VARCHAR(32) NOT NULL,
PMFKEY VARCHAR(8) NOT NULL,
PROFILE_NAME VARCHAR(255) NOT NULL,
PROFILE_DESC VARCHAR(255) NOT NULL,
RESCLASS VARCHAR(8) NOT NULL,
AUTH VARCHAR(255) NOT NULL,
AUTH_TYPE VARCHAR(1),
ACCESS VARCHAR(9),
CHNG_DT VARCHAR(25),
ADMIN VARCHAR(20),
PRIMARY KEY (USER_ACCESS_ADDED_ID));

CREATE TABLE TSS.USER_ACCESS_REMOVED
(USER_ACCESS_REMOVED_ID IDENTITY NOT NULL,
ATTESTATION_ID BIGINT NOT NULL,
REPOSITORY INT NOT NULL,
USER_ACCESS_ID BIGINT NOT NULL,
PRIMARY KEY (USER_ACCESS_REMOVED_ID));
